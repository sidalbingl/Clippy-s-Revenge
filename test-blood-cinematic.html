<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blood Cinematic Test</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      background: #1a1a1a;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }

    .test-container {
      position: fixed;
      top: 20px;
      left: 20px;
      z-index: 10000;
      background: rgba(0, 0, 0, 0.8);
      padding: 20px;
      border-radius: 8px;
      color: white;
    }

    button {
      background: #8b0000;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
    }

    button:hover {
      background: #a00000;
    }

    .avatar-placeholder {
      position: fixed;
      width: 100px;
      height: 100px;
      background: #5a6a80;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 48px;
      transition: all 400ms cubic-bezier(0.16, 1, 0.3, 1);
      z-index: 9999;
    }

    /* Blood drip animations */
    @keyframes bloodDrip1 {
      0% { transform: translateY(-150px); opacity: 0; }
      10% { opacity: 1; }
      100% { transform: translateY(100vh); opacity: 0.8; }
    }

    @keyframes bloodDrip2 {
      0% { transform: translateY(-180px) translateX(0); opacity: 0; }
      10% { opacity: 1; }
      50% { transform: translateY(50vh) translateX(3px); }
      100% { transform: translateY(100vh) translateX(-2px); opacity: 0.8; }
    }

    @keyframes bloodDrip3 {
      0% { transform: translateY(-200px); opacity: 0; }
      15% { opacity: 1; }
      100% { transform: translateY(100vh); opacity: 0.9; }
    }

    @keyframes bloodDrip4 {
      0% { transform: translateY(-140px) translateX(0); opacity: 0; }
      10% { opacity: 1; }
      40% { transform: translateY(40vh) translateX(-2px); }
      100% { transform: translateY(100vh) translateX(4px); opacity: 0.7; }
    }

    @keyframes bloodDrip4Split {
      0% { transform: translateY(-140px) scale(0); opacity: 0; }
      50% { transform: translateY(-140px) scale(0); opacity: 0; }
      55% { opacity: 1; transform: translateY(0) scale(1); }
      100% { transform: translateY(60vh) translateX(-8px); opacity: 0.6; }
    }

    @keyframes bloodDrip5 {
      0% { transform: translateY(-120px); opacity: 0; }
      8% { opacity: 1; }
      100% { transform: translateY(100vh); opacity: 0.75; }
    }

    @keyframes bloodDrip6 {
      0% { transform: translateY(-170px) translateX(0); opacity: 0; }
      12% { opacity: 1; }
      60% { transform: translateY(60vh) translateX(-4px); }
      100% { transform: translateY(100vh) translateX(2px); opacity: 0.8; }
    }

    @keyframes bloodSmear {
      0% { opacity: 0; }
      50% { opacity: 0; }
      100% { opacity: 0.15; }
    }

    .blood-drip-1 {
      animation: bloodDrip1 1.8s cubic-bezier(0.3, 0.7, 0.1, 1) forwards;
    }

    .blood-drip-2 {
      animation: bloodDrip2 2.2s cubic-bezier(0.3, 0.7, 0.1, 1) forwards;
    }

    .blood-drip-3 {
      animation: bloodDrip3 2.5s cubic-bezier(0.3, 0.7, 0.1, 1) forwards;
    }

    .blood-drip-4 {
      animation: bloodDrip4 2.0s cubic-bezier(0.3, 0.7, 0.1, 1) forwards;
    }

    .blood-drip-4-split {
      animation: bloodDrip4Split 2.0s cubic-bezier(0.3, 0.7, 0.1, 1) forwards;
    }

    .blood-drip-5 {
      animation: bloodDrip5 1.6s cubic-bezier(0.3, 0.7, 0.1, 1) forwards;
    }

    .blood-drip-6 {
      animation: bloodDrip6 2.1s cubic-bezier(0.3, 0.7, 0.1, 1) forwards;
    }

    .blood-smear {
      animation: bloodSmear 2.5s ease-out forwards;
    }
  </style>
</head>
<body>
  <div class="test-container">
    <h2>ü©∏ Blood Cinematic Test</h2>
    <button onclick="triggerCinematic()">Trigger HIGH Severity</button>
    <p id="status">Ready</p>
  </div>

  <div class="avatar-placeholder" id="avatar">
    üìé
  </div>

  <script>
    const avatar = document.getElementById('avatar');
    const status = document.getElementById('status');
    let isRunning = false;

    // Set initial random position
    avatar.style.left = Math.random() * (window.innerWidth - 100) + 'px';
    avatar.style.top = Math.random() * (window.innerHeight - 100) + 'px';

    async function triggerCinematic() {
      if (isRunning) return;
      isRunning = true;
      status.textContent = 'üé¨ Running cinematic...';

      // Remove any existing overlays
      const existingOverlay = document.getElementById('cinematic-overlay');
      if (existingOverlay) existingOverlay.remove();

      // STEP 2: Fly to center - SLOWER
      avatar.style.transition = 'all 800ms cubic-bezier(0.16, 1, 0.3, 1)';
      const centerX = window.innerWidth / 2 - 50;
      const centerY = window.innerHeight / 2 - 50;
      avatar.style.left = centerX + 'px';
      avatar.style.top = centerY + 'px';
      status.textContent = '‚úàÔ∏è Flying to center...';

      await sleep(800);

      // STEP 3: Close eyes - MUCH SLOWER
      status.textContent = 'üò¥ Closing eyes...';
      avatar.textContent = 'üòë';
      await sleep(1400);

      // STEP 4: Screen darkening - SLOWER
      status.textContent = 'üåë Darkening screen...';
      const overlay = document.createElement('div');
      overlay.id = 'cinematic-overlay';
      overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        opacity: 0;
        transition: opacity 1500ms ease-in;
        z-index: 9998;
        pointer-events: none;
      `;
      document.body.appendChild(overlay);

      setTimeout(() => overlay.style.opacity = '1', 10);
      await sleep(1800);

      // STEP 5: Eyes snap open
      status.textContent = 'üëÅÔ∏è Eyes snap open!';
      avatar.textContent = 'üò±';

      // STEP 6: Blood effect - LONGER ANIMATIONS
      status.textContent = 'ü©∏ BLOOD DRIPPING...';
      const bloodSvg = createBloodSVG();
      document.body.appendChild(bloodSvg);

      await sleep(5000);

      // STEP 8: Fade out - SLOWER
      status.textContent = 'üå´Ô∏è Fading out...';
      overlay.style.transition = 'opacity 1200ms ease-out';
      overlay.style.opacity = '0';
      bloodSvg.style.transition = 'opacity 1200ms ease-out';
      bloodSvg.style.opacity = '0';

      await sleep(1200);

      overlay.remove();
      bloodSvg.remove();
      avatar.textContent = 'üìé';
      avatar.style.transition = 'none';
      
      status.textContent = '‚úÖ Complete! Ready for next test.';
      isRunning = false;
    }

    function createBloodSVG() {
      const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
      svg.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9999;
      `;

      svg.innerHTML = `
        <defs>
          <linearGradient id="bloodGradient" x1="0%" y1="0%" x2="0%" y2="100%">
            <stop offset="0%" stop-color="#8b0000" />
            <stop offset="50%" stop-color="#660000" />
            <stop offset="100%" stop-color="#300000" />
          </linearGradient>
          <linearGradient id="bloodGloss" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="transparent" />
            <stop offset="30%" stop-color="#ff2b2b" stop-opacity="0.2" />
            <stop offset="70%" stop-color="#ff2b2b" stop-opacity="0.2" />
            <stop offset="100%" stop-color="transparent" />
          </linearGradient>
          <filter id="noiseFilter">
            <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="4" />
            <feColorMatrix type="saturate" values="0" />
          </filter>
        </defs>

        <g class="blood-drips">
          <path d="M 15,0 Q 12,-5 10,10 Q 8,30 10,50 Q 12,70 10,90 Q 8,110 12,130 L 18,130 Q 22,110 20,90 Q 18,70 20,50 Q 22,30 20,10 Q 18,-5 15,0 Z" fill="url(#bloodGradient)" class="blood-drip-1" />
          <path d="M 15,0 Q 12,-5 10,10 Q 8,30 10,50 Q 12,70 10,90 Q 8,110 12,130 L 18,130 Q 22,110 20,90 Q 18,70 20,50 Q 22,30 20,10 Q 18,-5 15,0 Z" fill="url(#bloodGloss)" class="blood-drip-1" />

          <path d="M 35,0 Q 32,-8 28,15 Q 25,40 28,65 Q 30,90 28,115 Q 26,140 30,165 L 40,165 Q 44,140 42,115 Q 40,90 42,65 Q 45,40 42,15 Q 38,-8 35,0 Z" fill="url(#bloodGradient)" class="blood-drip-2" />
          <path d="M 35,0 Q 32,-8 28,15 Q 25,40 28,65 Q 30,90 28,115 Q 26,140 30,165 L 40,165 Q 44,140 42,115 Q 40,90 42,65 Q 45,40 42,15 Q 38,-8 35,0 Z" fill="url(#bloodGloss)" class="blood-drip-2" />

          <path d="M 50,0 Q 45,-10 42,20 Q 38,50 42,80 Q 45,110 42,140 Q 38,170 45,200 L 55,200 Q 62,170 58,140 Q 55,110 58,80 Q 62,50 58,20 Q 55,-10 50,0 Z" fill="url(#bloodGradient)" class="blood-drip-3" />
          <path d="M 50,0 Q 45,-10 42,20 Q 38,50 42,80 Q 45,110 42,140 Q 38,170 45,200 L 55,200 Q 62,170 58,140 Q 55,110 58,80 Q 62,50 58,20 Q 55,-10 50,0 Z" fill="url(#bloodGloss)" class="blood-drip-3" />

          <path d="M 70,0 Q 67,-6 65,12 Q 62,35 65,58 Q 68,80 65,100 L 68,100 Q 70,85 72,70 Q 75,50 72,30 Q 70,10 73,0 Z" fill="url(#bloodGradient)" class="blood-drip-4" />
          <path d="M 65,100 Q 62,120 65,140 L 70,140 Q 73,120 70,100 Z" fill="url(#bloodGradient)" class="blood-drip-4-split" />

          <path d="M 85,0 Q 83,-4 82,8 Q 80,25 82,42 Q 84,60 82,78 Q 80,95 83,112 L 87,112 Q 90,95 88,78 Q 86,60 88,42 Q 90,25 88,8 Q 86,-4 85,0 Z" fill="url(#bloodGradient)" class="blood-drip-5" />

          <path d="M 95,0 Q 92,-7 90,14 Q 87,38 90,62 Q 93,86 90,110 Q 87,134 92,158 L 98,158 Q 103,134 100,110 Q 97,86 100,62 Q 103,38 100,14 Q 97,-7 95,0 Z" fill="url(#bloodGradient)" class="blood-drip-6" />
        </g>

        <rect x="0" y="0" width="100%" height="80" fill="#8b0000" opacity="0.15" filter="url(#noiseFilter)" class="blood-smear" />
      `;

      return svg;
    }

    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms));
    }
  </script>
</body>
</html>
